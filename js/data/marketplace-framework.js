/* ============================================================
   The Prompt Generation - Marketplace Framework (Standalone)
   Source taxonomy: 1-15 Prompts.pdf
   Notes:
   - This file does NOT modify existing page behavior.
   - It provides a scalable category/subcategory/template blueprint.
   ============================================================ */

'use strict';

(function attachMarketplaceFramework(globalScope) {
  const TEMPLATE_GOALS = [
    'Plan a complete strategy for {SUBCATEGORY}',
    'Generate a step-by-step execution workflow for {SUBCATEGORY}',
    'Audit and improve an existing process in {SUBCATEGORY}',
    'Create a beginner-to-advanced learning path for {SUBCATEGORY}',
    'Design a measurable KPI framework for {SUBCATEGORY}',
    'Build a risk assessment and mitigation plan for {SUBCATEGORY}',
    'Produce a checklist and SOP for {SUBCATEGORY}',
    'Draft a stakeholder-ready summary for {SUBCATEGORY}',
    'Create an implementation roadmap with milestones for {SUBCATEGORY}',
    'Develop a troubleshooting and optimization guide for {SUBCATEGORY}',
  ];

  const TEMPLATE_OUTPUTS = [
    'Output as a concise executive brief',
    'Output as a detailed standard operating procedure',
    'Output as a table with priorities, impact, and effort',
    'Output as a phased 30-60-90 day plan',
    'Output as a practical template with placeholders',
  ];

  const TEMPLATE_CONSTRAINTS = [
    'Assume budget: {BUDGET}',
    'Assume timeline: {TIMELINE}',
    'Assume team size: {TEAM_SIZE}',
    'Assume tools: {TOOLS}',
    'Assume risk tolerance: {RISK_TOLERANCE}',
  ];

  function generateFiftyTemplates(categoryName, subcategoryName) {
    const templates = [];

    for (let goalIdx = 0; goalIdx < TEMPLATE_GOALS.length; goalIdx += 1) {
      for (let outIdx = 0; outIdx < TEMPLATE_OUTPUTS.length; outIdx += 1) {
        const constraint = TEMPLATE_CONSTRAINTS[(goalIdx + outIdx) % TEMPLATE_CONSTRAINTS.length];
        templates.push(
          [
            `You are an elite specialist in ${categoryName}.`,
            TEMPLATE_GOALS[goalIdx].replace('{SUBCATEGORY}', subcategoryName),
            TEMPLATE_OUTPUTS[outIdx],
            `${constraint}.`,
            'Include: assumptions, dependencies, common pitfalls, and next actions.',
            'Use placeholders in [BRACKETS] for user inputs.',
          ].join(' ')
        );
      }
    }

    return templates; // Exactly 50 templates (10 x 5)
  }

  function normalizeToTwentyFive(subcategories) {
    return subcategories.slice(0, 25);
  }

  const frameworkCategories = [
    {
      id: 'cat-01',
      name: 'Coding & Development',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Web Development',
        'Mobile Development',
        'Game Development',
        'Backend Development',
        'Frontend Development',
        'Full-Stack Development',
        'Database Design & Optimization',
        'API Design & Integration',
        'Cloud Architecture & DevOps',
        'Continuous Integration & Delivery',
        'Testing & Quality Assurance',
        'Security & Compliance',
        'Performance Optimization',
        'Algorithm Design & Analysis',
        'Data Structures & Patterns',
        'Software Architecture & Patterns',
        'Debugging & Troubleshooting',
        'Version Control & Collaboration',
        'Code Review & Best Practices',
        'Low-Code & No-Code Tools',
        'Open-Source Contribution & Maintenance',
        'Data Engineering & ETL',
        'UI/UX for Developers',
        'Scripting & Automation',
        'Embedded Systems & IoT',
      ]),
    },
    {
      id: 'cat-02',
      name: 'Business & Entrepreneurship',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Business Planning & Validation',
        'Pricing & Monetization Models',
        'Market Research & Competitive Analysis',
        'Branding & Identity Development',
        'Legal, Tax & Compliance',
        'Funding & Investment Strategies',
        'Financial Management & Budgeting',
        'Operations & Scalability',
        'Product Development & MVP Design',
        'Sales Strategy & Customer Acquisition',
        'Customer Retention & Loyalty',
        'Partnerships & Collaboration',
        'Team Building & Hiring',
        'Leadership & Management',
        'Marketing & Positioning Strategy',
        'Go-to-Market & Launch Planning',
        'Digital Transformation for Business',
        'Risk Management & Contingency',
        'Strategic Planning & Growth',
        'Negotiation & Contract Management',
        'Business Analytics & KPIs',
        'Remote & Distributed Teams',
        'Global Expansion & Localization',
        'Customer Support & Success',
        'Licensing & Intellectual Property',
      ]),
    },
    {
      id: 'cat-03',
      name: 'Marketing & Growth',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'SEO & Keyword Research',
        'Content Marketing & Blogging',
        'Social Media Strategy & Management',
        'Email Marketing & Automation',
        'Paid Advertising & PPC',
        'Influencer & Affiliate Marketing',
        'Video & Livestream Marketing',
        'Podcast Marketing & Distribution',
        'Branding & Messaging',
        'Growth Hacking & Viral Loops',
        'Data-Driven Marketing & Analytics',
        'Customer Journey Mapping',
        'Conversion Rate Optimization',
        'Landing Page Design & Testing',
        'Funnel Building & Automation',
        'Lead Generation & Nurturing',
        'Product Launch & Campaigns',
        'Community Building & Advocacy',
        'User-Generated Content Strategy',
        'Retention & Churn Reduction',
        'A/B Testing & Experimentation',
        'Social Proof & Case Studies',
        'Offline & Event Marketing',
        'Marketing Tech Stack & Automation',
        'Cross-Channel Integration & Attribution',
      ]),
    },
    {
      id: 'cat-04',
      name: 'Content Creation',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Long-Form Article Writing',
        'Blogging & Editorial Strategy',
        'Short-Form Copywriting',
        'Video Scriptwriting & Storyboarding',
        'Podcast Scripting & Planning',
        'Storytelling & Narrative Development',
        'Technical Writing & Documentation',
        'Editing & Proofreading',
        'Visual Design & Graphics',
        'Photography & Image Sourcing',
        'Audio Recording & Production',
        'Video Editing & Post-Production',
        'Social Media Post Creation',
        'Infographics & Data Visualization',
        'Presentation & Slide Design',
        'E-Book & Whitepaper Creation',
        'Newsletter Writing & Curation',
        'Ghostwriting & Collaboration',
        'Interview & Guest Content Creation',
        'Captioning & Subtitles',
        'Idea Generation & Brainstorming',
        'Creative Planning & Scheduling',
        'SEO Optimization for Content',
        'Content Repurposing Across Channels',
        'Style Guides & Brand Voice',
      ]),
    },
    {
      id: 'cat-05',
      name: 'AI & Automation',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'AI Prompt Engineering & Templates',
        'Chatbot & Virtual Assistant Design',
        'Model Selection & Training',
        'Data Labeling & Annotation',
        'Natural Language Processing Techniques',
        'Computer Vision Integration',
        'Speech & Audio Analysis',
        'Recommendation Systems',
        'Predictive Analytics & Forecasting',
        'Automation Pipeline Design',
        'Workflow Automation with n8n/Zapier',
        'Agent-Based Autonomous Systems',
        'Low-Code AI Integrations',
        'Self-Hosted LLM Deployment',
        'Model Evaluation & Benchmarking',
        'Orchestration & Multi-Agent Systems',
        'Auto-Scheduling & Reminder Systems',
        'Data Extraction & ETL Automation',
        'Real-Time AI & Streaming',
        'AI-Driven Marketing & Growth',
        'AI Ethics & Fairness',
        'Personalization & User Modeling',
        'Robotics & IoT Automation',
        'Autonomous Research Agents',
        'AI Security & Risk Mitigation',
      ]),
    },
    {
      id: 'cat-06',
      name: 'Sports & Athletic Performance',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Strength & Conditioning Programming',
        'Endurance Training & Periodization',
        'Sports Nutrition & Supplementation',
        'Injury Prevention & Rehabilitation',
        'Biomechanics & Movement Analysis',
        'Team Dynamics & Coaching',
        'Sports Analytics & Performance Tracking',
        'Talent Scouting & Athlete Development',
        'Mental Toughness & Sports Psychology',
        'Sports Event Planning & Operations',
        'Athlete Branding & Sponsorship Management',
        'Youth Sports Development Programs',
        'Elite Sports Training Facilities Design',
        'Adaptive & Paralympic Sports Coaching',
        'Sports Technology & Wearable Integration',
        'Referee & Officiating Best Practices',
        'Sports Governance & Compliance',
        'Fan Engagement & Stadium Experience',
        'Game Strategy & Tactical Analysis',
        'Player Contract Negotiation & Management',
        'Sports Media Production & Commentary',
        'Esports Coaching & Management',
        'Athlete Career Transition Planning',
        'Sports Medicine Innovations & Biohacking',
        'Community Sports Programs & Outreach',
      ]),
    },
    {
      id: 'cat-07',
      name: 'Travel & Lifestyle Experiences',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Adventure Travel Planning & Safety',
        'Sustainable & Eco-Friendly Tourism',
        'Digital Nomad & Remote Work Lifestyle',
        'Luxury Travel & Concierge Services',
        'Budget Travel & Backpacking Strategies',
        'Cultural Immersion & Local Experiences',
        'Expedition Leadership & Risk Planning',
        'Cruise & Maritime Travel Planning',
        'Travel Photography & Blogging',
        'Travel Health & Safety Preparations',
        'Travel Insurance & Risk Management',
        'Global Citizenship & Residency Planning',
        'Culinary Travel & Food Tours',
        'Festival & Event Tourism',
        'Group Travel & Itinerary Coordination',
        'Pet-Friendly Travel Planning',
        'Family & Multigenerational Travel',
        'Sustainable Transportation & Mobility',
        'Language Learning for Travelers',
        'Accommodation & Hospitality Reviews',
        'Airline Loyalty & Points Optimization',
        'Remote Island & Off-Grid Destinations',
        'Adventure Gear & Equipment Selection',
        'Travel Tech & Apps Utilization',
        'Post-Trip Content Creation & Monetization',
      ]),
    },
    {
      id: 'cat-08',
      name: 'Legal & Regulatory Strategy',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Contract Drafting & Negotiation',
        'Intellectual Property Protection & Licensing',
        'Corporate Governance & Compliance',
        'Employment Law & HR Policies',
        'International Trade & Customs Regulations',
        'Tax Strategy & Planning',
        'Data Privacy & Cybersecurity Law',
        'Risk Assessment & Liability Management',
        'Mergers & Acquisitions Legal Due Diligence',
        'Litigation Strategy & Case Management',
        'Regulatory Affairs & Government Relations',
        'Environmental Law & Sustainability Compliance',
        'Real Estate & Property Law',
        'Immigration & Global Mobility Law',
        'Financial Services & Securities Regulation',
        'Healthcare & Life Sciences Compliance',
        'Antitrust & Competition Law',
        'Legal Tech & Automation Tools',
        'Legal Project Management & Operations',
        'Legal Ethics & Professional Responsibility',
        'Nonprofit & Charity Law',
        'Intellectual Property Valuation & Monetization',
        'Dispute Resolution & Arbitration Techniques',
        'Cybercrime & Digital Forensics Law',
        'International Arbitration & Cross-Border Litigation',
      ]),
    },
    {
      id: 'cat-09',
      name: 'Manufacturing & Supply Chain Optimization',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Lean Manufacturing & Six Sigma Techniques',
        'Inventory Management & Demand Forecasting',
        'Quality Control & Assurance Systems',
        'Supplier Relationship & Procurement Strategy',
        'Automation & Robotics Integration',
        'Smart Factory & Industry 4.0 Implementation',
        'Logistics & Transportation Management',
        'Warehouse Design & Optimization',
        'Supply Chain Risk Management',
        'Sustainability & Green Manufacturing',
        'Product Lifecycle Management',
        'Just-in-Time & Kanban Systems',
        'Supply Chain Finance & Cost Control',
        'Reverse Logistics & Returns Management',
        'Global Sourcing & Trade Compliance',
        'Capacity Planning & Resource Allocation',
        'Custom Manufacturing & Rapid Prototyping',
        'Predictive Maintenance & Asset Management',
        'Cross-Border Shipping & Customs',
        'Supply Chain Data Analytics & Visualization',
        'Product Traceability & Blockchain',
        'Supplier Diversity & Ethical Sourcing',
        'Supply Chain Collaboration & Integration',
        'Manufacturing Workforce Training & Safety',
        'Circular Economy & Zero-Waste Manufacturing',
      ]),
    },
    {
      id: 'cat-10',
      name: 'Art & Design Mastery',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Fine Art Techniques & Materials',
        'Sculpture & 3D Art Creation',
        'Fashion Design & Textile Innovation',
        'Industrial Design & Product Prototyping',
        'Architectural Design Principles',
        'Interior Design & Space Planning',
        'Landscape Design & Urban Green Spaces',
        'Photography Techniques & Editing',
        'Calligraphy & Typography Arts',
        'Digital Illustration & Concept Art',
        'Printmaking & Graphic Arts',
        'Ceramics & Pottery Crafting',
        'Jewelry Design & Gemology',
        'Motion Graphics & Animation',
        'Sound Design & Audio Art',
        'Lighting Design & Stagecraft',
        'Art History & Theory Analysis',
        'Exhibition Curation & Gallery Management',
        'Public Art & Installation Design',
        'Art Therapy & Creative Wellness',
        'Set Design & Scenic Construction',
        'Restoration & Conservation Techniques',
        'Visual Merchandising & Display',
        'Art Entrepreneurship & Gallery Ownership',
        'Cross-Cultural Artistic Collaborations',
      ]),
    },
    {
      id: 'cat-11',
      name: 'Health Optimization & Bio-Performance',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Clinical Nutrition Strategy & Protocol Design',
        'Hormonal Optimization & Endocrine Health',
        'Gut Microbiome & Digestive Health Systems',
        'Sleep Architecture & Circadian Optimization',
        'Longevity & Anti-Aging Interventions',
        'Preventative Health Screening & Biomarker Tracking',
        'Functional Medicine & Root Cause Analysis',
        'Metabolic Flexibility & Energy Systems',
        'Recovery Science & Regenerative Therapies',
        'Stress Physiology & Cortisol Regulation',
        'Immune System Optimization & Resilience',
        'Cognitive Enhancement & Neuroplasticity',
        'Breathwork & Oxygen Utilization Training',
        'Detoxification Pathways & Liver Support',
        'Anti-Inflammatory Lifestyle Design',
        'Cardiovascular Performance & VO2 Max Training',
        'Mitochondrial Health & Cellular Energy',
        'Personalized Supplement Stack Design',
        "Women's Hormonal Cycle Optimization",
        "Men's Testosterone & Performance Strategy",
        'Health Data Quantification & Wearable Analytics',
        'Cold & Heat Exposure Protocols',
        'Environmental Toxin Mitigation',
        'Genetic Testing & Precision Health Planning',
        'Habit-Based Health System Engineering',
      ]),
    },
    {
      id: 'cat-12',
      name: 'Wealth Architecture & Asset Strategy',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Personal Asset Allocation & Portfolio Design',
        'Dividend & Cashflow Investing',
        'Real Estate Portfolio Structuring',
        'Alternative Assets & Private Equity',
        'Precious Metals & Commodity Hedging',
        'Digital Assets & Blockchain Holdings',
        'Tax-Efficient Wealth Structuring',
        'Offshore Strategy & Global Banking',
        'Estate Planning & Intergenerational Wealth',
        'Trusts & Asset Protection Structures',
        'High-Net-Worth Insurance Strategy',
        'Passive Income Systems Engineering',
        'Royalty & Intellectual Asset Monetization',
        'Risk Diversification Modeling',
        'Macro-Economic Trend Positioning',
        'Inflation Protection Strategies',
        'High-Value Skill Monetization',
        'Sovereign Residency & Wealth Migration',
        'Capital Preservation & Defensive Investing',
        'Venture Capital & Angel Investment Framework',
        'Impact Investing & ESG Strategies',
        'Family Office Systems Design',
        'Wealth Psychology & Decision Biases',
        'Liquidity Planning & Exit Strategy',
        'Crisis Wealth Protection Planning',
      ]),
    },
    {
      id: 'cat-13',
      name: 'Psychology & Human Behavior Mastery',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Cognitive Bias Identification & Correction',
        'Behavioral Habit Rewiring Systems',
        'Emotional Regulation & Stability Training',
        'Social Influence & Persuasion Dynamics',
        'Conflict Resolution & Mediation Psychology',
        'Negotiation Psychology & Framing',
        'Trauma Recovery & Emotional Processing',
        'Motivation Systems & Drive Engineering',
        'Focus & Attention Mastery',
        'Decision-Making Under Uncertainty',
        'Leadership Psychology & Authority',
        'Personality Profiling & Archetypes',
        'Relationship Attachment Dynamics',
        'Resilience & Adversity Adaptation',
        'High-Stakes Communication Control',
        'Group Dynamics & Crowd Behavior',
        'Identity Reconstruction & Reinvention',
        'Fear Deconstruction & Exposure Systems',
        'Behavioral Economics in Daily Life',
        'Subconscious Pattern Recognition',
        'Habit Loop Engineering',
        'Influence Detection & Manipulation Defense',
        'Confidence Architecture',
        'Narrative Identity & Personal Story Reframing',
        'Peak State Induction Techniques',
      ]),
    },
    {
      id: 'cat-14',
      name: 'Real Estate & Built Environment',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Residential Investment Analysis',
        'Commercial Property Evaluation',
        'Short-Term Rental Optimization',
        'Real Estate Development & Land Use Planning',
        'Property Renovation & Value Engineering',
        'Zoning & Regulatory Navigation',
        'Property Management Systems',
        'Smart Home Integration & Automation',
        'Sustainable & Green Building Design',
        'Real Estate Financing Structures',
        'Property Tax Strategy',
        'Luxury Property Marketing',
        'Real Estate Syndication Models',
        'Mixed-Use Development Strategy',
        'Urban Revitalization Planning',
        'Land Acquisition & Due Diligence',
        'Property Flipping Risk Modeling',
        'Multi-Family Portfolio Scaling',
        'Real Estate Legal Risk Mitigation',
        'Architectural Feasibility Analysis',
        'Construction Budget Control',
        'Infrastructure & Utilities Planning',
        'International Real Estate Investing',
        'Co-Living & Community Housing Models',
        'Real Estate Exit & Disposition Strategy',
      ]),
    },
    {
      id: 'cat-15',
      name: 'Energy & Infrastructure Systems',
      source: '1-15 Prompts.pdf',
      subcategories: normalizeToTwentyFive([
        'Renewable Energy Project Planning',
        'Solar Farm Development Strategy',
        'Wind Energy Infrastructure Design',
        'Energy Storage & Battery Systems',
        'Smart Grid Implementation',
        'Nuclear Energy Policy & Safety',
        'Oil & Gas Asset Evaluation',
        'Hydrogen Fuel Systems Engineering',
        'Electric Vehicle Charging Networks',
        'Microgrid Design & Deployment',
        'Grid Resilience & Disaster Recovery',
        'Energy Efficiency Auditing',
        'Carbon Credit & Offset Strategy',
        'Sustainable Urban Energy Planning',
        'Power Purchase Agreement Structuring',
        'Utility-Scale Project Financing',
        'Water Infrastructure & Treatment Systems',
        'Waste-to-Energy Solutions',
        'Energy Market Trading Strategy',
        'Infrastructure Risk Assessment',
        'Environmental Impact Modeling',
        'Energy Data Analytics',
        'Rural Electrification Strategy',
        'Industrial Energy Optimization',
        'National Energy Security Planning',
      ]),
    },
    /* ── Categories 16-19 (formerly "legacy") ── */
    {
      id: 'legacy-writing',
      name: 'Writing & Communication',
      source: 'core',
      subcategories: normalizeToTwentyFive([
        'Academic Writing',
        'Business Writing',
        'Email Writing',
        'Creative Nonfiction',
        'Essay Structuring',
        'Editing Workflows',
        'Summarization Writing',
        'Technical Explanations',
        'Script Writing',
        'Prompted Journaling',
        'Persuasive Writing',
        'Story Openers',
        'Dialogue Crafting',
        'Headline Writing',
        'Newsletter Drafting',
        'Speech Writing',
        'Documentation Writing',
        'Case Study Writing',
        'Landing Page Copy',
        'Product Descriptions',
        'UX Microcopy',
        'Report Writing',
        'Proposal Writing',
        'Interview Q&A Writing',
        'Voice and Tone Adaptation',
      ]),
    },
    {
      id: 'legacy-creative',
      name: 'Creative Writing & Fiction',
      source: 'core',
      subcategories: normalizeToTwentyFive([
        'Story Ideation',
        'Character Profiles',
        'Worldbuilding',
        'Creative Constraints',
        'Plot Outlining',
        'Poetry Drafting',
        'Visual Story Concepts',
        'Creative Brainstorming',
        'Narrative Hooks',
        'Genre Blending',
        'Tone Experiments',
        'Prompt Remixing',
        'Idea Expansion',
        'Scene Rewrites',
        'Moodboard Prompting',
        'Myth and Lore Creation',
        'Script Beat Sheets',
        'Story Endings',
        'Brand Storytelling',
        'Creative Direction',
        'Metaphor Generation',
        'Image-to-Story Prompts',
        'Concept Pitching',
        'Creative Feedback Loops',
        'Experimental Formats',
      ]),
    },
    {
      id: 'legacy-education',
      name: 'Education & Learning',
      source: 'core',
      subcategories: normalizeToTwentyFive([
        'Lesson Planning',
        'Course Structuring',
        'Quiz Generation',
        'Flashcard Creation',
        'Socratic Tutoring',
        'Exam Preparation',
        'Study Schedules',
        'Concept Simplification',
        'Curriculum Mapping',
        'Learning Objectives',
        'Project-Based Learning',
        'Assessment Rubrics',
        'Classroom Activities',
        'Homework Design',
        'Peer Review Activities',
        'Research Skills',
        'Critical Thinking Exercises',
        'Reading Comprehension',
        'STEM Explanations',
        'Language Learning',
        'Writing Feedback',
        'Differentiated Instruction',
        'Parent Communication',
        'Learning Analytics',
        'Educational Content Adaptation',
      ]),
    },
    {
      id: 'legacy-general',
      name: 'Productivity & Daily Life',
      source: 'core',
      subcategories: normalizeToTwentyFive([
        'Daily Productivity',
        'Decision Frameworks',
        'Meeting Preparation',
        'Personal Planning',
        'Life Admin Automation',
        'Research Summaries',
        'Goal Setting',
        'Habit Tracking',
        'Career Development',
        'Interview Prep',
        'Time Management',
        'Task Prioritization',
        'Communication Templates',
        'Problem Solving',
        'Idea Validation',
        'Checklist Builders',
        'Risk-Reward Analysis',
        'Personal Knowledge Management',
        'Learning Plans',
        'Project Kickoffs',
        'Documentation Templates',
        'Reflection Prompts',
        'Multi-step Workflows',
        'General Brainstorming',
        'Cross-domain Synthesis',
      ]),
    },
  ];

  // Legacy categories have been merged into frameworkCategories above (indices 15-18).
  // Kept as empty array for any code that still references it.
  const legacyCategories = [];

  function materializeCategory(category) {
    return {
      id: category.id,
      name: category.name,
      source: category.source,
      subcategories: category.subcategories.map((subcategoryName) => ({
        name: subcategoryName,
        promptTemplates: generateFiftyTemplates(category.name, subcategoryName),
      })),
    };
  }

  function buildMarketplaceDataset() {
    const fullCategories = frameworkCategories.map(materializeCategory);

    return {
      metadata: {
        frameworkName: 'AI Prompt Marketplace - 19 Category Framework',
        generatedAt: new Date().toISOString(),
        categoryCount: fullCategories.length,
        subcategoriesPerCategory: 25,
        templatesPerSubcategory: 50,
      },
      categories: fullCategories,
      legacyCategories: [], // merged into categories above
    };
  }

  function summarizeDataset(dataset) {
    const totalSubcats      = dataset.categories.reduce((acc, cat) => acc + cat.subcategories.length, 0);
    const templatesPerSubcat = dataset.metadata.templatesPerSubcategory;

    return {
      totalCategories:     dataset.categories.length,
      totalSubcategories:  totalSubcats,
      totalTemplates:      totalSubcats * templatesPerSubcat,
    };
  }

  const MARKETPLACE_FRAMEWORK = {
    version: '1.0.0',
    frameworkCategories,
    legacyCategories,
    buildMarketplaceDataset,
    summarizeDataset,
  };

  globalScope.PROMPT_MARKETPLACE_FRAMEWORK = MARKETPLACE_FRAMEWORK;
})(window);


